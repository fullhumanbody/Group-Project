<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-EN">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <head>
        <title>Hide 'n Show</title>
        <link rel="stylesheet" href="IntegratedPages.css">
    </head>

    <body class="spotlight-container page0Body",>

    <!------------------------------------------------------------------------------------------------------------------------------------>
        <button onclick="showpage()">Click me! I'll show you the next page!</button>

        <div class="page0"> <!-- Page 0 content ###################################################################################------------>
            <button onclick="showpage()">Pretend I'm the start button</button>
        </div> <!-- End of Page 0 content #######################################################################################################-->

        <div class="page1"> <!-- Page 1 content ###################################################################################------------>
          <div id="page1lampWrapper">
          <img id="page1handLamp" src="lamp-temp-glow.png" />
          </div>
          <div class="page1banner"></div>
          <div id="page1counter">Catch some bugs!</div>

        </div> <!-- End of Page 1 content #######################################################################################################-->
        <div class="page2">
            This is page 2 test test
        </div>
        <div class="page3">
            This is page 3 test test
        </div>
        <div class="page4">
            This is page 4 test test
        </div>
        <div class="page5">
            This is page 5 test test
        </div>
        <div class="page6">
            This is page 6 test test
        </div>
        <div class="page7">
            This is page 7 test test
        </div>
        <div class="page8">
            This is page 8 test test
        </div>
        <div class="page9">
            This is page 9 test test
        </div>
        <div class="page10">
            This is page 10 test test
        </div>
        <div class="page11">
            This is page 11 test test
        </div>
        <div class="page12">
            This is page 12 test test
        </div>
        <div class="page13">
            This is page 13 test test
        </div>
        <div class="page14">
            This is page 14 test test
        </div>






    <!------------------------------------------------------------------------------------------------------------------------------------>
    </body>




<script>


// Crazy Bug Game Code Below  ########################################################################################################################################
let bugsZapped = 0;
let maxZaps = 30;
let spawnInterval;  // store interval so we can stop spawning bugs
let bugEnd = true;

function properEndGame() {
  clearInterval(spawnInterval);
  if (bugEnd === true) {
    alert("Congratulations, you have zapped 30 bugs!");
    showpage();
    bugEnd = false;
  } else {
    bugEnd = false;
}
}

  function createBug() {
    const bug = document.createElement("div");
    bug.className = "page1bug";         
    document.body.appendChild(bug);

    const bodyWidth = window.innerWidth;
    const bodyHeight = window.innerHeight;

    let posX = Math.random() * (bodyWidth - 80);
    let posY = Math.random() * (bodyHeight - 80);

    let speed = 4;
    let angle = Math.random() * Math.PI * 2;
    let velX = Math.cos(angle) * speed;
    let velY = Math.sin(angle) * speed;

    function moveBug() {
      posX += velX;
      posY += velY;

      if (posX <= 0 || posX >= bodyWidth - 80) velX *= -1;
      if (posY <= 0 || posY >= bodyHeight - 80) velY *= -1;

      velX += (Math.random() - 0.5) * 0.4;
      velY += (Math.random() - 0.5) * 0.4;
      velX = Math.max(Math.min(velX, 5), -5);
      velY = Math.max(Math.min(velY, 5), -5);

      bug.style.left = posX + "px";
      bug.style.top = posY + "px";

      const lamp = document.getElementById("page1lampWrapper");

      
      // zap counter
   
   if (isColliding(bug, lamp)) {
  bug.remove();

  bugsZapped++;
  document.getElementById("page1counter").textContent = "Bugs caught: " + bugsZapped;

  if (bugsZapped >= maxZaps) {
    endGame();
  }

        return;
      }

      requestAnimationFrame(moveBug);
    }

    moveBug();
  }




    function isColliding(a, b) {
    const r1 = a.getBoundingClientRect();
    const r2 = b.getBoundingClientRect();

    return !(r1.right < r2.left ||
             r1.left > r2.right ||
             r1.bottom < r2.top ||
             r1.top > r2.bottom);
  }

  function endGame() {
  clearInterval(spawnInterval);
  properEndGame();
  bugEnd = false;

}

window.onload = function () {


  // spawn 1 bugs at the start
  for (let i = 0; i < 1; i++) {
    createBug();
  }

  // spawn bugs continuously
  //spawnInterval = setInterval(createBug, 1000);

  
};





// the lamp code
$(function () {
  let isDragging = false;
  let offsetX, offsetY;

  $("#page1lampWrapper").on("mousedown", function (e) {
    isDragging = true;
    offsetX = e.clientX - $(this).position().left;
    offsetY = e.clientY - $(this).position().top;
    $(this).css("cursor", "grabbing");
  });

  $(document).on("mousemove", function (e) {
    if (isDragging) {
      $("#page1lampWrapper").css({
        left: e.clientX - offsetX,
        top: e.clientY - offsetY
      });
    }
  });

  $(document).on("mouseup", function () {
    isDragging = false;
    $("#page1lampWrapper").css("cursor", "grab");
  });
});


function removeDivsByClass(className) {
    // 1. Select all elements that match the class name.
    // document.querySelectorAll() returns a NodeList of all matching elements.
    const elementsToRemove = document.querySelectorAll(`div.${className}`);

    // 2. Iterate through the NodeList and remove each element.
    // A for...of loop or Array.from().forEach() works well for NodeLists.
    elementsToRemove.forEach(element => {
        // The element must be removed from its parent node.
        if (element.parentNode) {
            element.parentNode.removeChild(element);
        }
        // Alternatively, the more modern and concise way:
        // element.remove(); 
    });
}





//if (playerReward === 0){

  const spotlightContainer = document.querySelector('.spotlight-container');

  spotlightContainer.addEventListener('mousemove', (e) => {
      spotlightContainer.style.setProperty('--cursorX', `${e.clientX}px`);
      spotlightContainer.style.setProperty('--cursorY', `${e.clientY}px`);
  });
//}






    var page0 = document.getElementsByClassName("page0");
    page0 = page0[0];
    var page1 = document.getElementsByClassName("page1");
    page1 = page1[0];
    var page2 = document.getElementsByClassName("page2");
    page2 = page2[0];
    var page3 = document.getElementsByClassName("page3");
    page3 = page3[0];
    var page4 = document.getElementsByClassName("page4");
    page4 = page4[0];
    var page5 = document.getElementsByClassName("page5");
    page5 = page5[0];
    var page6 = document.getElementsByClassName("page6");
    page6 = page6[0];
    var page7 = document.getElementsByClassName("page7");
    page7 = page7[0];
    var page8 = document.getElementsByClassName("page8");
    page8 = page8[0];
    var page9 = document.getElementsByClassName("page9");
    page9 = page9[0];
    var page10 = document.getElementsByClassName("page10");
    page10 = page10[0];
    var page11 = document.getElementsByClassName("page11");
    page11 = page11[0];
    var page12 = document.getElementsByClassName("page12");
    page12 = page12[0];
    var page13 = document.getElementsByClassName("page13");
    page13 = page13[0];
    var page14 = document.getElementsByClassName("page14");
    page14 = page14[0];
    console.log("The page works");


let playerReward = 0;
if (typeof playerReward !== 'undefined') {
    console.log("playerReward exists with value: " + playerReward);
} else {
    console.log("playerReward does not exist");
}

page1.style.display = "none";
page2.style.display = "none";
page3.style.display = "none";
page4.style.display = "none";
page5.style.display = "none";
page6.style.display = "none";
page7.style.display = "none";
page8.style.display = "none";
page9.style.display = "none";
page10.style.display = "none";
page11.style.display = "none";
page12.style.display = "none";
page13.style.display = "none";
page14.style.display = "none";

function showpage() {
    console.log("showpageTest function called");
    playerReward = playerReward + 1;

        console.log("playerReward is now: " + playerReward);
        if (playerReward === 1) {
            page1.style.display = "block";
            page0.style.display = "none";
            document.body.classList.remove("spotlight-container","page0Body");
            document.body.classList.add("page1Body");
            spawnInterval = setInterval(createBug, 500);
        } else if (playerReward === 2 && bugsZapped >= maxZaps) {
            playerReward = 2;
            console.log("Switching to page 2");
            page2.style.display = "block";
            page1.style.display = "none";
            document.body.classList.remove("page1Body");
            //document.body.classList.add("page2Body");
            removeDivsByClass('page1bug');
            console.log("The other stuff works so like. Oh well i guess?");
        } else if (playerReward === 3) {
            page3.style.display = "block";
            page2.style.display = "none";
        } else if (playerReward === 4) {
            page4.style.display = "block";
            page3.style.display = "none";
        } else if (playerReward === 5) {
            page4.style.display = "none";
            page5.style.display = "block";
        } else if (playerReward === 6) {
            page5.style.display = "none";
            page6.style.display = "block";
        } else if (playerReward === 7) {
            page6.style.display = "none";
            page7.style.display = "block";
        } else if (playerReward === 8) {
            page7.style.display = "none";
            page8.style.display = "block";
        } else if (playerReward === 9) {
            page8.style.display = "none";
            page9.style.display = "block";
        } else if (playerReward === 10) {
            page9.style.display = "none";
            page10.style.display = "block";
        } else if (playerReward === 11) {
            page10.style.display = "none";
            page11.style.display = "block";
        } else if (playerReward === 12) {
            page11.style.display = "none";
            page12.style.display = "block";
        } else if (playerReward === 13) {
            page12.style.display = "none";
            page13.style.display = "block";
        } else if (playerReward === 14) {
            page13.style.display = "none";
            page14.style.display = "block";
        } else {
            console.log("No valid reward");
        }

}





</script>


</html>


